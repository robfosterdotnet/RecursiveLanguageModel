# Repository Guidelines

This repository is a Next.js 16 document analysis app implementing Recursive Language Models (RLM) for long document processing.

## Project Structure and Module Organization
- `src/app/` Next.js App Router pages and API routes (`src/app/api/*` for analyze and parse endpoints).
- `src/components/` shared UI components, including shadcn/ui building blocks.
- `src/lib/analysis/` analysis core: chunking, retrieval, graph mode, prompts, and analysis types.
- `src/lib/llm/` Azure OpenAI client wrapper(s).
- `src/config/` environment validation helpers (see `src/config/env.ts`).
- `src/test/` Vitest setup, MSW mocks, fixtures, and utilities; tests live alongside code as `*.test.ts` or `*.test.tsx`.
- `public/` static assets; `coverage/` is generated by coverage runs; `walmartContract.pdf` is a sample document (copied to `src/test/fixtures/documents/` for tests).

## Build, Test, and Development Commands
- `npm run dev`: start the Next.js dev server with hot reload.
- `npm run build`: create a production build; `npm run start` serves it.
- `npm run lint`: run ESLint (Next core web vitals + TypeScript rules).
- `npm run test`: Vitest in watch mode; `npm run test:run`: single run.
- `npm run test:coverage`: run tests with coverage output in `coverage/`.
- `npm run test:ui`: launch the Vitest UI.

## Coding Style and Naming Conventions
- TypeScript with `strict` enabled; keep types explicit for public APIs in `src/lib/analysis` and `src/config`.
- Match existing formatting: 2-space indentation, double quotes, and existing line wrapping.
- React components use PascalCase, hooks use `useX`, and Next route files use `page.tsx` and `layout.tsx`.
- Prefer the `@/` alias for `src` imports (e.g., `@/lib/analysis/analyze`).

## Testing Guidelines
- Vitest + React Testing Library with `jsdom`; global setup in `src/test/setup.ts`.
- Use MSW handlers in `src/test/mocks` for API and OpenAI stubs.
- Coverage thresholds: 80% statements/lines/functions, 75% branches.

## Commit and Pull Request Guidelines
- Use Conventional Commits seen in history (e.g., `feat: ...`, `fix: ...`, `chore: ...`).
- PRs should include a concise summary, tests run, and linked issues.
- Include screenshots or recordings for UI-facing changes.

## Configuration and Secrets
- Add Azure OpenAI settings in `.env.local` (`AZURE_OPENAI_ENDPOINT`, `AZURE_OPENAI_API_KEY`, deployments, API version).
- Never commit `.env.local` or other secrets.
